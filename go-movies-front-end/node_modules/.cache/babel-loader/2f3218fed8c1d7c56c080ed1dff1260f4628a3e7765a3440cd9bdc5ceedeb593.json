{"ast":null,"code":"import{useEffect,useState}from\"react\";import Input from\"./form/Input\";import{Link}from\"react-router-dom\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const GraphQL=()=>{//// Setup the stateful variables.....\nconst[movies,setMovies]=useState([]);const[searchTerm,setSearchTerm]=useState(\"\");const[fullList,setFullList]=useState([]);//// Perform a search.....\nconst performSearch=()=>{const payload=\"\\n    {\\n      search(titleContains : \\\"\".concat(searchTerm,\"\\\") {\\n         id\\n         title\\n         runtime\\n         release_date\\n         mpaa_rating\\n      }\\n    }\");const headers=new Headers();headers.append(\"Content-Type\",\"application/graphql\");const requestOptions={method:\"POST\",body:payload,headers:headers};fetch(\"\".concat(process.env.REACT_APP_BACKEND,\"/graph\"),requestOptions).then(response=>response.json()).then(response=>{let theList=Object.values(response.data.search);setMovies(theList);}).catch(error=>{console.log(error);});};const handleChange=event=>{event.preventDefault();let value=event.target.value;setSearchTerm(value);if(value.length>2){performSearch();}else{setMovies(fullList);}};//// useEffect\nuseEffect(()=>{const payload=\"\\n    {\\n      list {\\n        id\\n        title\\n        runtime\\n        release_date\\n        mpaa_rating\\n      }\\n    }\";const headers=new Headers();headers.append(\"Content-Type\",\"application/graphql\");const requestOptions={method:\"POST\",headers:headers,body:payload};fetch(\"\".concat(process.env.REACT_APP_BACKEND,\"/graph\"),requestOptions).then(response=>response.json()).then(response=>{let theList=Object.values(response.data.list);setMovies(theList);setFullList(theList);}).catch(err=>{console.log(err);});},[]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Graph Ql\"}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(\"form\",{onSubmit:handleChange,children:/*#__PURE__*/_jsx(Input,{title:\"Search\",type:\"search\",name:\"search\",className:\"form-control\",value:searchTerm,onChange:handleChange})}),movies?/*#__PURE__*/_jsxs(\"table\",{className:\"table table-striped table-hover\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Movie\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Release Date\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Rating\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:movies.map(m=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(Link,{to:\"/movies/\".concat(m.id),children:m.title})}),/*#__PURE__*/_jsx(\"td\",{children:new Date(m.release_date).toLocaleDateString()}),/*#__PURE__*/_jsx(\"td\",{children:m.mpaa_rating})]},m.id))})]}):/*#__PURE__*/_jsx(\"p\",{children:\"No movies (yet)\"})]});};export default GraphQL;","map":{"version":3,"names":["useEffect","useState","Input","Link","jsx","_jsx","jsxs","_jsxs","GraphQL","movies","setMovies","searchTerm","setSearchTerm","fullList","setFullList","performSearch","payload","concat","headers","Headers","append","requestOptions","method","body","fetch","process","env","REACT_APP_BACKEND","then","response","json","theList","Object","values","data","search","catch","error","console","log","handleChange","event","preventDefault","value","target","length","list","err","children","onSubmit","title","type","name","className","onChange","map","m","to","id","Date","release_date","toLocaleDateString","mpaa_rating"],"sources":["D:/Go/React-With-Go/go-movies-front-end/src/components/GraphQL.js"],"sourcesContent":["import { useEffect, useState } from \"react\";\r\nimport Input from \"./form/Input\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\nconst GraphQL = () => {\r\n  //// Setup the stateful variables.....\r\n\r\n  const [movies, setMovies] = useState([]);\r\n\r\n  const [searchTerm, setSearchTerm] = useState(\"\");\r\n\r\n  const [fullList, setFullList] = useState([]);\r\n\r\n  //// Perform a search.....\r\n\r\n  const performSearch = () => {\r\n    const payload = `\r\n    {\r\n      search(titleContains : \"${searchTerm}\") {\r\n         id\r\n         title\r\n         runtime\r\n         release_date\r\n         mpaa_rating\r\n      }\r\n    }`;\r\n\r\n    const headers = new Headers();\r\n    headers.append(\"Content-Type\", \"application/graphql\");\r\n\r\n    const requestOptions = {\r\n      method: \"POST\",\r\n      body: payload,\r\n      headers: headers,\r\n    };\r\n\r\n    fetch(`${process.env.REACT_APP_BACKEND}/graph`, requestOptions)\r\n      .then((response) => response.json())\r\n      .then((response) => {\r\n        let theList = Object.values(response.data.search);\r\n        setMovies(theList);\r\n      })\r\n      .catch((error) => {\r\n        console.log(error);\r\n      });\r\n  };\r\n\r\n  const handleChange = (event) => {\r\n    event.preventDefault();\r\n\r\n    let value = event.target.value;\r\n    setSearchTerm(value);\r\n\r\n    if (value.length > 2) {\r\n      performSearch();\r\n    } else {\r\n      setMovies(fullList);\r\n    }\r\n  };\r\n\r\n  //// useEffect\r\n  useEffect(() => {\r\n    const payload = `\r\n    {\r\n      list {\r\n        id\r\n        title\r\n        runtime\r\n        release_date\r\n        mpaa_rating\r\n      }\r\n    }`;\r\n\r\n    const headers = new Headers();\r\n    headers.append(\"Content-Type\", \"application/graphql\");\r\n\r\n    const requestOptions = {\r\n      method: \"POST\",\r\n      headers: headers,\r\n      body: payload,\r\n    };\r\n\r\n    fetch(`${process.env.REACT_APP_BACKEND}/graph`, requestOptions)\r\n      .then((response) => response.json())\r\n      .then((response) => {\r\n        let theList = Object.values(response.data.list);\r\n        setMovies(theList);\r\n        setFullList(theList);\r\n      })\r\n      .catch((err) => {\r\n        console.log(err);\r\n      });\r\n  }, []);\r\n\r\n  return (\r\n    <div>\r\n      <h2>Graph Ql</h2>\r\n      <hr />\r\n\r\n      <form onSubmit={handleChange}>\r\n        <Input\r\n          title={\"Search\"}\r\n          type={\"search\"}\r\n          name={\"search\"}\r\n          className={\"form-control\"}\r\n          value={searchTerm}\r\n          onChange={handleChange}\r\n        />\r\n      </form>\r\n\r\n      {movies ? (\r\n        <table className=\"table table-striped table-hover\">\r\n          <thead>\r\n            <tr>\r\n              <th>Movie</th>\r\n              <th>Release Date</th>\r\n              <th>Rating</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {movies.map((m) => (\r\n              <tr key={m.id}>\r\n                <td>\r\n                  <Link to={`/movies/${m.id}`}>{m.title}</Link>\r\n                </td>\r\n                <td>{new Date(m.release_date).toLocaleDateString()}</td>\r\n                <td>{m.mpaa_rating}</td>\r\n              </tr>\r\n            ))}\r\n          </tbody>\r\n        </table>\r\n      ) : (\r\n        <p>No movies (yet)</p>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default GraphQL;\r\n"],"mappings":"AAAA,OAASA,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAC3C,MAAO,CAAAC,KAAK,KAAM,cAAc,CAChC,OAASC,IAAI,KAAQ,kBAAkB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAExC,KAAM,CAAAC,OAAO,CAAGA,CAAA,GAAM,CACpB;AAEA,KAAM,CAACC,MAAM,CAAEC,SAAS,CAAC,CAAGT,QAAQ,CAAC,EAAE,CAAC,CAExC,KAAM,CAACU,UAAU,CAAEC,aAAa,CAAC,CAAGX,QAAQ,CAAC,EAAE,CAAC,CAEhD,KAAM,CAACY,QAAQ,CAAEC,WAAW,CAAC,CAAGb,QAAQ,CAAC,EAAE,CAAC,CAE5C;AAEA,KAAM,CAAAc,aAAa,CAAGA,CAAA,GAAM,CAC1B,KAAM,CAAAC,OAAO,4CAAAC,MAAA,CAEeN,UAAU,qHAOpC,CAEF,KAAM,CAAAO,OAAO,CAAG,GAAI,CAAAC,OAAO,CAAC,CAAC,CAC7BD,OAAO,CAACE,MAAM,CAAC,cAAc,CAAE,qBAAqB,CAAC,CAErD,KAAM,CAAAC,cAAc,CAAG,CACrBC,MAAM,CAAE,MAAM,CACdC,IAAI,CAAEP,OAAO,CACbE,OAAO,CAAEA,OACX,CAAC,CAEDM,KAAK,IAAAP,MAAA,CAAIQ,OAAO,CAACC,GAAG,CAACC,iBAAiB,WAAUN,cAAc,CAAC,CAC5DO,IAAI,CAAEC,QAAQ,EAAKA,QAAQ,CAACC,IAAI,CAAC,CAAC,CAAC,CACnCF,IAAI,CAAEC,QAAQ,EAAK,CAClB,GAAI,CAAAE,OAAO,CAAGC,MAAM,CAACC,MAAM,CAACJ,QAAQ,CAACK,IAAI,CAACC,MAAM,CAAC,CACjDzB,SAAS,CAACqB,OAAO,CAAC,CACpB,CAAC,CAAC,CACDK,KAAK,CAAEC,KAAK,EAAK,CAChBC,OAAO,CAACC,GAAG,CAACF,KAAK,CAAC,CACpB,CAAC,CAAC,CACN,CAAC,CAED,KAAM,CAAAG,YAAY,CAAIC,KAAK,EAAK,CAC9BA,KAAK,CAACC,cAAc,CAAC,CAAC,CAEtB,GAAI,CAAAC,KAAK,CAAGF,KAAK,CAACG,MAAM,CAACD,KAAK,CAC9B/B,aAAa,CAAC+B,KAAK,CAAC,CAEpB,GAAIA,KAAK,CAACE,MAAM,CAAG,CAAC,CAAE,CACpB9B,aAAa,CAAC,CAAC,CACjB,CAAC,IAAM,CACLL,SAAS,CAACG,QAAQ,CAAC,CACrB,CACF,CAAC,CAED;AACAb,SAAS,CAAC,IAAM,CACd,KAAM,CAAAgB,OAAO,+HASX,CAEF,KAAM,CAAAE,OAAO,CAAG,GAAI,CAAAC,OAAO,CAAC,CAAC,CAC7BD,OAAO,CAACE,MAAM,CAAC,cAAc,CAAE,qBAAqB,CAAC,CAErD,KAAM,CAAAC,cAAc,CAAG,CACrBC,MAAM,CAAE,MAAM,CACdJ,OAAO,CAAEA,OAAO,CAChBK,IAAI,CAAEP,OACR,CAAC,CAEDQ,KAAK,IAAAP,MAAA,CAAIQ,OAAO,CAACC,GAAG,CAACC,iBAAiB,WAAUN,cAAc,CAAC,CAC5DO,IAAI,CAAEC,QAAQ,EAAKA,QAAQ,CAACC,IAAI,CAAC,CAAC,CAAC,CACnCF,IAAI,CAAEC,QAAQ,EAAK,CAClB,GAAI,CAAAE,OAAO,CAAGC,MAAM,CAACC,MAAM,CAACJ,QAAQ,CAACK,IAAI,CAACY,IAAI,CAAC,CAC/CpC,SAAS,CAACqB,OAAO,CAAC,CAClBjB,WAAW,CAACiB,OAAO,CAAC,CACtB,CAAC,CAAC,CACDK,KAAK,CAAEW,GAAG,EAAK,CACdT,OAAO,CAACC,GAAG,CAACQ,GAAG,CAAC,CAClB,CAAC,CAAC,CACN,CAAC,CAAE,EAAE,CAAC,CAEN,mBACExC,KAAA,QAAAyC,QAAA,eACE3C,IAAA,OAAA2C,QAAA,CAAI,UAAQ,CAAI,CAAC,cACjB3C,IAAA,QAAK,CAAC,cAENA,IAAA,SAAM4C,QAAQ,CAAET,YAAa,CAAAQ,QAAA,cAC3B3C,IAAA,CAACH,KAAK,EACJgD,KAAK,CAAE,QAAS,CAChBC,IAAI,CAAE,QAAS,CACfC,IAAI,CAAE,QAAS,CACfC,SAAS,CAAE,cAAe,CAC1BV,KAAK,CAAEhC,UAAW,CAClB2C,QAAQ,CAAEd,YAAa,CACxB,CAAC,CACE,CAAC,CAEN/B,MAAM,cACLF,KAAA,UAAO8C,SAAS,CAAC,iCAAiC,CAAAL,QAAA,eAChD3C,IAAA,UAAA2C,QAAA,cACEzC,KAAA,OAAAyC,QAAA,eACE3C,IAAA,OAAA2C,QAAA,CAAI,OAAK,CAAI,CAAC,cACd3C,IAAA,OAAA2C,QAAA,CAAI,cAAY,CAAI,CAAC,cACrB3C,IAAA,OAAA2C,QAAA,CAAI,QAAM,CAAI,CAAC,EACb,CAAC,CACA,CAAC,cACR3C,IAAA,UAAA2C,QAAA,CACGvC,MAAM,CAAC8C,GAAG,CAAEC,CAAC,eACZjD,KAAA,OAAAyC,QAAA,eACE3C,IAAA,OAAA2C,QAAA,cACE3C,IAAA,CAACF,IAAI,EAACsD,EAAE,YAAAxC,MAAA,CAAauC,CAAC,CAACE,EAAE,CAAG,CAAAV,QAAA,CAAEQ,CAAC,CAACN,KAAK,CAAO,CAAC,CAC3C,CAAC,cACL7C,IAAA,OAAA2C,QAAA,CAAK,GAAI,CAAAW,IAAI,CAACH,CAAC,CAACI,YAAY,CAAC,CAACC,kBAAkB,CAAC,CAAC,CAAK,CAAC,cACxDxD,IAAA,OAAA2C,QAAA,CAAKQ,CAAC,CAACM,WAAW,CAAK,CAAC,GALjBN,CAAC,CAACE,EAMP,CACL,CAAC,CACG,CAAC,EACH,CAAC,cAERrD,IAAA,MAAA2C,QAAA,CAAG,iBAAe,CAAG,CACtB,EACE,CAAC,CAEV,CAAC,CAED,cAAe,CAAAxC,OAAO","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}